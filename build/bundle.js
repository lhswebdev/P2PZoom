var app=function(){"use strict";function t(){}const n=t=>t;function e(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(e)}function u(t){return"function"==typeof t}function c(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function i(n,e,o){n.$$.on_destroy.push(function(n,...e){if(null==n)return t;const o=n.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}(e,o))}const s="undefined"!=typeof window;let l=s?()=>window.performance.now():()=>Date.now(),a=s?t=>requestAnimationFrame(t):t;const f=new Set;function d(t){f.forEach((n=>{n.c(t)||(f.delete(n),n.f())})),0!==f.size&&a(d)}function p(t,n){t.appendChild(n)}function h(t){if(!t)return document;const n=t.getRootNode?t.getRootNode():t.ownerDocument;return n&&n.host?n:t.ownerDocument}function m(t){const n=y("style");return function(t,n){p(t.head||t,n)}(h(t),n),n}function $(t,n,e){t.insertBefore(n,e||null)}function g(t){t.parentNode.removeChild(t)}function y(t){return document.createElement(t)}function b(t){return document.createTextNode(t)}function _(){return b(" ")}function v(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function w(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function x(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function E(t,n){t.value=null==n?"":n}function k(t,n,e=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e,!1,n),o}const R=new Set;let O,j=0;function A(t,n,e,o,r,u,c,i=0){const s=16.666/o;let l="{\n";for(let t=0;t<=1;t+=s){const o=n+(e-n)*u(t);l+=100*t+`%{${c(o,1-o)}}\n`}const a=l+`100% {${c(e,1-e)}}\n}`,f=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(a)}_${i}`,d=h(t);R.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=m(t).sheet),$=d.__svelte_rules||(d.__svelte_rules={});$[f]||($[f]=!0,p.insertRule(`@keyframes ${f} ${a}`,p.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${o}ms linear ${r}ms 1 both`,j+=1,f}function C(t,n){const e=(t.style.animation||"").split(", "),o=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),r=e.length-o.length;r&&(t.style.animation=o.join(", "),j-=r,j||a((()=>{j||(R.forEach((t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}})),R.clear())})))}function N(t){O=t}function S(){if(!O)throw new Error("Function called outside component initialization");return O}const z=[],D=[],P=[],F=[],M=Promise.resolve();let T=!1;function q(){T||(T=!0,M.then(B))}function G(){return q(),M}function L(t){P.push(t)}let U=!1;const W=new Set;function B(){if(!U){U=!0;do{for(let t=0;t<z.length;t+=1){const n=z[t];N(n),Y(n.$$)}for(N(null),z.length=0;D.length;)D.pop()();for(let t=0;t<P.length;t+=1){const n=P[t];W.has(n)||(W.add(n),n())}P.length=0}while(z.length);for(;F.length;)F.pop()();T=!1,U=!1,W.clear()}}function Y(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(L)}}let H;function I(t,n,e){t.dispatchEvent(k(`${n?"intro":"outro"}${e}`))}const J=new Set;let K;function Q(){K={r:0,c:[],p:K}}function V(){K.r||r(K.c),K=K.p}function X(t,n){t&&t.i&&(J.delete(t),t.i(n))}function Z(t,n,e,o){if(t&&t.o){if(J.has(t))return;J.add(t),K.c.push((()=>{J.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}const tt={duration:0};function nt(e,o,c,i){let s=o(e,c),p=i?0:1,h=null,m=null,$=null;function g(){$&&C(e,$)}function y(t,n){const e=t.b-p;return n*=Math.abs(e),{a:p,b:t.b,d:e,duration:n,start:t.start,end:t.start+n,group:t.group}}function b(o){const{delay:u=0,duration:c=300,easing:i=n,tick:b=t,css:_}=s||tt,v={start:l()+u,b:o};o||(v.group=K,K.r+=1),h||m?m=v:(_&&(g(),$=A(e,p,o,c,u,i,_)),o&&b(0,1),h=y(v,c),L((()=>I(e,o,"start"))),function(t){let n;0===f.size&&a(d),new Promise((e=>{f.add(n={c:t,f:e})}))}((t=>{if(m&&t>m.start&&(h=y(m,c),m=null,I(e,h.b,"start"),_&&(g(),$=A(e,p,h.b,h.duration,0,i,s.css))),h)if(t>=h.end)b(p=h.b,1-p),I(e,h.b,"end"),m||(h.b?g():--h.group.r||r(h.group.c)),h=null;else if(t>=h.start){const n=t-h.start;p=h.a+h.d*i(n/h.duration),b(p,1-p)}return!(!h&&!m)})))}return{run(t){u(s)?(H||(H=Promise.resolve(),H.then((()=>{H=null}))),H).then((()=>{s=s(),b(t)})):b(t)},end(){g(),h=m=null}}}function et(t){t&&t.c()}function ot(t,n,o,c){const{fragment:i,on_mount:s,on_destroy:l,after_update:a}=t.$$;i&&i.m(n,o),c||L((()=>{const n=s.map(e).filter(u);l?l.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(L)}function rt(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function ut(n,e,u,c,i,s,l,a=[-1]){const f=O;N(n);const d=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:i,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:e.context||[]),callbacks:o(),dirty:a,skip_bound:!1,root:e.target||f.$$.root};l&&l(d.root);let p=!1;if(d.ctx=u?u(n,e.props||{},((t,e,...o)=>{const r=o.length?o[0]:e;return d.ctx&&i(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),p&&function(t,n){-1===t.$$.dirty[0]&&(z.push(t),q(),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}(n,t)),e})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!c&&c(d.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);d.fragment&&d.fragment.l(t),t.forEach(g)}else d.fragment&&d.fragment.c();e.intro&&X(n.$$.fragment),ot(n,e.target,e.anchor,e.customElement),B()}N(f)}class ct{$destroy(){rt(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const it=[];function st(n,e=t){let o;const r=new Set;function u(t){if(c(n,t)&&(n=t,o)){const t=!it.length;for(const t of r)t[1](),it.push(t,n);if(t){for(let t=0;t<it.length;t+=2)it[t][0](it[t+1]);it.length=0}}}return{set:u,update:function(t){u(t(n))},subscribe:function(c,i=t){const s=[c,i];return r.add(s),1===r.size&&(o=e(u)||t),c(n),()=>{r.delete(s),0===r.size&&(o(),o=null)}}}}const lt=st("...generating id..."),at=st(""),ft=new window.Peer;function dt(n){let e,o,u,c,i,s,l;return{c(){e=y("input"),o=_(),u=y("button"),c=b("Go!"),w(e,"placeholder","Who would you like to talk to?"),u.disabled=i=0==n[0].length},m(t,r){$(t,e,r),E(e,n[0]),$(t,o,r),$(t,u,r),p(u,c),s||(l=[v(e,"keydown",n[2]),v(e,"input",n[3]),v(u,"click",n[4])],s=!0)},p(t,[n]){1&n&&e.value!==t[0]&&E(e,t[0]),1&n&&i!==(i=0==t[0].length)&&(u.disabled=i)},i:t,o:t,d(t){t&&g(e),t&&g(o),t&&g(u),s=!1,r(l)}}}function pt(t,n,e){let o,r;i(t,at,(t=>e(0,r=t)));const u=function(){const t=S();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const r=k(n,e);o.slice().forEach((n=>{n.call(t,r)}))}}}();return t.$$.update=()=>{1&t.$$.dirty&&(o=0==r.length)},[r,u,t=>{"Enter"!=t.key||o||u("next")},function(){r=this.value,at.set(r)},()=>u("next")]}ft.on("open",(t=>lt.set(t)));class ht extends ct{constructor(t){super(),ut(this,t,pt,dt,c,{})}}function mt(t){const n=t-1;return n*n*n+1}function $t(t,{delay:n=0,duration:e=400,easing:o=mt,x:r=0,y:u=0,opacity:c=0}={}){const i=getComputedStyle(t),s=+i.opacity,l="none"===i.transform?"":i.transform,a=s*(1-c);return{delay:n,duration:e,easing:o,css:(t,n)=>`\n\t\t\ttransform: ${l} translate(${(1-t)*r}px, ${(1-t)*u}px);\n\t\t\topacity: ${s-a*n}`}}function gt(n){let e,o,r,u;return{c(){e=y("p"),o=b("Waiting for "),r=b(n[2]),u=b(" to pick up")},m(t,n){$(t,e,n),p(e,o),p(e,r),p(e,u)},p(t,n){4&n&&x(r,t[2])},i:t,o:t,d(t){t&&g(e)}}}function yt(n){let e,o,r,u;return{c(){e=y("div"),o=y("video"),o.autoplay=!0},m(t,r){$(t,e,r),p(e,o),n[3](o),u=!0},p:t,i(t){u||(L((()=>{r||(r=nt(e,$t,{x:-800,duration:2e3},!0)),r.run(1)})),u=!0)},o(t){r||(r=nt(e,$t,{x:-800,duration:2e3},!1)),r.run(0),u=!1},d(t){t&&g(e),n[3](null),t&&r&&r.end()}}}function bt(t){let n,e,o,r;const u=[yt,gt],c=[];function i(t,n){return t[1]?0:1}return n=i(t),e=c[n]=u[n](t),{c(){e.c(),o=b("")},m(t,e){c[n].m(t,e),$(t,o,e),r=!0},p(t,[r]){let s=n;n=i(t),n===s?c[n].p(t,r):(Q(),Z(c[s],1,1,(()=>{c[s]=null})),V(),e=c[n],e?e.p(t,r):(e=c[n]=u[n](t),e.c()),X(e,1),e.m(o.parentNode,o))},i(t){r||(X(e),r=!0)},o(t){Z(e),r=!1},d(t){c[n].d(t),t&&g(o)}}}function _t(t,n,e){let o,r;i(t,at,(t=>e(2,o=t)));let u=!1;var c;return c=()=>(ft.on("error",(t=>console.error("GOT PEER ERROR",t))),window.navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((t=>{ft.call(o,t).on("stream",(async t=>{e(1,u=!0),await G(),e(0,r.srcObject=t,r)}))})).catch((t=>{console.error("Failed to get local stream",t)})),ft.on("call",(t=>{window.navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((n=>{t.answer(n),t.on("stream",(async t=>{e(1,u=!0),await G(),e(0,r.srcObject=t,r)}))})).catch((t=>{console.error("Failed to get local stream",t)}))})),()=>e(1,u=!1)),S().$$.on_mount.push(c),[r,u,o,function(t){D[t?"unshift":"push"]((()=>{r=t,e(0,r)}))}]}class vt extends ct{constructor(t){super(),ut(this,t,_t,bt,c,{})}}function wt(t){let n,e,o,r,u,c,i;var s=t[2][t[0]];return s&&(c=new s({}),c.$on("next",t[3])),{c(){n=y("main"),e=y("p"),o=b("Your id is "),r=b(t[1]),u=_(),c&&et(c.$$.fragment),w(n,"class","svelte-177t831")},m(t,s){$(t,n,s),p(n,e),p(e,o),p(e,r),p(n,u),c&&ot(c,n,null),i=!0},p(t,[e]){if((!i||2&e)&&x(r,t[1]),s!==(s=t[2][t[0]])){if(c){Q();const t=c;Z(t.$$.fragment,1,0,(()=>{rt(t,1)})),V()}s?(c=new s({}),c.$on("next",t[3]),et(c.$$.fragment),X(c.$$.fragment,1),ot(c,n,null)):c=null}},i(t){i||(c&&X(c.$$.fragment,t),i=!0)},o(t){c&&Z(c.$$.fragment,t),i=!1},d(t){t&&g(n),c&&rt(c)}}}function xt(t,n,e){let o;i(t,lt,(t=>e(1,o=t)));let r=[ht,vt],u=0;return[u,o,r,()=>{u<r.length-1&&e(0,u++,u)}]}const Et=new class extends ct{constructor(t){super(),ut(this,t,xt,wt,c,{})}}({target:document.body,props:{}});return"undefined"!=typeof module&&module.hot&&("undefined"!=typeof module&&module.hot.dispose((()=>{Et.$destroy()})),"undefined"!=typeof module&&module.hot.accept()),Et}();
//# sourceMappingURL=bundle.js.map
